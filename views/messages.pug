extends base
include mixins/_conversation.pug
include mixins/_message.pug

block content
    .page-container.messages-page
        .messages__sidebar
            h2.messages__page-title Messages
            .conversations
                each convo in conversations
                    if (selectedConvo && convo._id.toString() === selectedConvo._id.toString())
                        +conversation(convo, true)
                    else
                        +conversation(convo)
        .messages__main
            if (!selectedConvo)
                p.system-note Your selected conversation will appear here.
            else
                .conversation-content
                    each message in selectedConvo.messages
                        +message(message, selectedConvo.participants[0], user)

            if (selectedConvo)
                form.new-message__form(data-convo-id=selectedConvo._id)
                    textarea.new-message__input
                    div
                        input(type="submit" value="Send").button-primary
    
    script(src='/socket.io/socket.io.js')